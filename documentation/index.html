<!doctype html>
<html>
  <head>
  <link rel="shortcut icon" href="/images/favicon.ico" type="image/png">
<link rel="apple-touch-icon" href="/images/mapsense-icon-60.png" sizes="60x60">
<link rel="apple-touch-icon" href="/images/mapsense-icon-76.png" sizes="76x76">
<link rel="apple-touch-icon" href="/images/mapsense-icon-120.png" sizes="120x120">
<link rel="apple-touch-icon" href="/images/mapsense-icon-152.png" sizes="152x152">

  <link href='//fonts.googleapis.com/css?family=Quattrocento+Sans:400,700' rel='stylesheet' type='text/css'>
  <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
  <link href="/stylesheets/stickyFooter.css" rel="stylesheet" type="text/css" />
  <style>
    tbody{
      background-color: white;
    }
    thead{
      background-color: #EEE;
    }
    .container{
      margin-bottom: 150px;
    }
    footer.footer div.container{
      margin-bottom: 0;
    }
    pre.prettyprint {
      padding:15px 15px !important;
    }
    div.main-content { background-color: #ffffff; }
  </style>
    <meta charset="utf-8">
    
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    
    <title>Mapsense Developer</title>
    
    <link href="/stylesheets/normalize.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/all.css" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </head>
  
  <body>
    <div class="container">
      <div class="row">
        <aside class="col-md-2 col-sm-2">
          
<h3 > <a href='/documentation/'>  Mapsense.js </a> </h3>
	<ul>
		<li>
			<h4>Core</h4>
			<ul class="list-unstyled">
			<li><a href="map.html">map</a></li>
			<li><a href="basemap.html">basemap</a></li>
			<li><a href="layer.html">layer</a></li>
			<li><a href="image.html">image</a></li>
			<li><a href="geoJson.html">geoJson</a></li>
			<li><a href="topoJson.html">topoJson</a></li>
			</ul>
		</li>
		<li>
			<h4>Controls</h4>
			<ul class="list-unstyled">
			<li><a href="arrow.html">arrow</a></li>
			<li><a href="compass.html">compass</a></li>
			<li><a href="dblclick.html">dblclick</a></li>
			<li><a href="drag.html">drag</a></li>
			<li><a href="grid.html">grid</a></li>
			<li><a href="hash.html">hash</a></li>
			<li><a href="interact.html">interact</a></li>
			<li><a href="wheel.html">wheel</a></li>
			</ul>
		</li>
		<li>
			<h4>Et cetera</h4>
			<ul class="list-unstyled">
			<li><a href="attribution.html">attribution</a></li>
			<li><a href="cache.html">cache</a></li>
			<li><a href="dispatch.html">dispatch</a></li>
			<li><a href="queue.html">queue</a></li>
			<li><a href="svg.html">svg</a></li>
			<li><a href="transform.html">transform</a></li>
			<li><a href="url.html">url</a></li>
			</ul>
		</li>
	</ul>

<h3 > <a href='/tileViewer'>Mapsense Data </a> </h3>
<ul>
	<ul class= "list-unstyled">
	<li><a href="tileRequests.html">Tile Paths</a></li>
	<li><a href="tileQueries.html">Tile Queries</a></li>
	<li><a href="featureProperties.html"> Feature Properties</a></li>
	<li><a href="contextAPI.html">Context API</a></li>
</ul>
</ul>

        </aside>
        <div class="col-md-10 col-sm-10 main-content">
          <div class="span-18 prepend-6 last mapContainer">
     <script src="/javascripts/d3.v3.min.js" type="text/javascript"></script>
     <script src="/javascripts/topojson.v1.min.js" type="text/javascript"></script>
     <script src="/mapsense.js" type="text/javascript"></script>

    <h2>Quick Start</h2>
    <hr class="space"/>

    <p><b>Mapsense.js</b> is a JavaScript library for vector maps in the browser. It brings the scalability of tiled geographic datasets to the interactivity, control, and dynamism of D3. A D3 selection is maintained across incoming tiles, letting you set things like styles or interaction just once. Mapsense.js is based on the <a href='http://www.polymaps.org'>Polymaps</a> API, but uses <a href='http://www.d3js.org'> D3 </a> to handle drawing and selection.  Having a basic <a href='https://github.com/mbostock/d3/wiki'>understanding</a> of D3 will make using Mapsense.js a snap.  Read these docs or check out the <a href='/examples/'>examples</a> to learn more about Mapsense.js.  </p>

     <p> <b> Mapsense Data </b> is a source of vector map data for creating interactive data driven maps. Data tiles are generated dynamically in response to a tile request, letting you control precisely what features and properties are returned. </p><br/>
    <h4><b>Initialization</b></h4>

    First of all, we need to include d3.js, topojson.js and mapsense.js:

    <pre class="prettyprint lang-js ">
&ltscript src="http://d3js.org/d3.v3.min.js" charset="utf-8"&gt&lt/script&gt
&ltscript src="http://d3js.org/topojson.v1.min.js" charset="utf-8"&gt&lt/script&gt
&ltscript src="https://developer.mapsense.co/mapsense.js" charset="utf-8"&gt&lt/script&gt</pre>
    Also, if you would like to use the default styles provided by Mapsense:

    <pre class="prettyprint lang-js ">
&ltlink  type="text/css"  href="https://developer.mapsense.co/mapsense.css" rel="stylesheet"/&gt</pre>
    You will need to create a node in the DOM for the map to be contained in with a unique ID:

    <pre class="prettyprint lang-js ">
&ltdiv id="myMap"&gt&lt/div&gt</pre>
    Now let's create a map and initialize it.  Here we create the map with a string representing the id attribute of the DOM node which the map will be contained in, and then call .center() and .zoom() to specify the initial viewpoint of the map.

    <pre class="prettyprint lang-js ">
var map = mapsense.map("#myMap")
  .center({lon: -122.410886, lat: 37.787041})
  .zoom(14);</pre>
    <br/>
    <h4><b>Basemap Layer</b></h4>
    Basemap provides default Mapsense tiles and controls. To define a basemap layer:

    <pre class="prettyprint lang-js ">
var basemapLayer = mapsense.basemap().apiKey(<b>{API_KEY}</b>);</pre>
    To add the basemap layer to your map and style the layer:

    <pre class="prettyprint lang-js ">
map.add(basemapLayer.style("tron")); </pre>
    In the example above, the "tron" style is included in mapsense.css.  If you would like to provide a <a href="http://styler.mapsense.co">custom style</a> for your basemap, you can link your own css stylesheet and then intialize the style with a false argument:

    <pre class="prettyprint lang-js ">
map.add(basemapLayer).style(false);
</pre>
The preset styles available for use in basemap are:
          <div class="container-70" >

  <div class="row" >

      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/light.jpg">
          <div>light</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/dark.jpg">
          <div>dark</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/parchment.jpg">
          <div>parchment</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/blackprint.jpg">
          <div>blackprint</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/grayscale.jpg">
          <div>grayscale</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/sketch.jpg">
          <div>sketch</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/tron.jpg">
          <div>tron</div>
        </span>
      </div>
      <div class="col-lg-3 col-sm-4">
        <span class="thumbnail">
          <img src="../images/vintage.jpg">
          <div>vintage</div>
        </span>
      </div>

  </div>

</div> <!-- /container -->

    <br/>
    <h4><b>Accessing and modifying map features</b></h4>

    One way to access individual map features in geoJson or topoJson layers before they are displayed is by using the selection() method.  This method sets a function that will be called on the D3 selection representing all of the geoJson (or topoJson) data in the map.  For example, to give all buildings a special class:

    <pre class="prettyprint lang-js ">
baseMapLayer.selection(function(d){
  d.attr("class", function(feature){
    if(feature.sub_layer == "building") {
      return "my_pretty_building";
    });</pre>

    Another option for accessing and formatting map data is to specify a load event handler.  The handler will be called after each tile is loaded and will be passed the tile containing the raw topology and the projection.  To access or mutate the feature list for geoJson or topoJson maps use tile.features(), which either returns the feature list, or sets the feature list if passed an argument.

    <pre class="prettyprint lang-js ">
var layer = mapsense.topoJson().on("load", loadLayer);
...
function loadLayer(tile, projection) {
  var newFeatures = [];
  tile.features().forEach(function(feature){
    var newFeature = processFeature(feature);  // processFeature performs some mutation on feature
    newFeatures.push(newFeature);
  }
  tile.features(newFeatures);
}</pre>
<div class="row">
      <div class="col-lg-3 col-sm-4">
        <a href="http://bl.ocks.org/mapsense-examples/00ee03b071e938ce6cc0" class="thumbnail" target="_blank">
          <img src="../../examples/images/choro.jpg">
          <div>using selection()</div>
        </a>
      </div>
  </div>
  <br/>
    <h4><b>geoJson and topoJson layers</b></h4>

    To bring static geoJson data in to your map, you can use d3's json function to load a local geojson file:
<pre class="prettyprint lang-js ">
d3.json("my_data.geojson", function(data){
  map.add(mapsense.geoJson()
    .features(data.features)
    .selection(function(d){
        d.attr("class", "neighborhood");
    })
  );
});</pre>
<div class="row">
      <div class="col-lg-3 col-sm-4">
        <a href="http://bl.ocks.org/mapsense-examples/e50c245eea328baca1c9" class="thumbnail" target="_blank">
          <img src="../../examples/images/geojson.jpg">
          <div>loading geoJson</div>
        </a>
      </div>
  </div>

  To load a remote topoJson layer, we specify the url when we create the layer.  For example, to display the "hurricanes" layer through the Mapsense API:
<pre class="prettyprint lang-js ">
var hurricaneUrl = "https://{S}-api.mapsense.co/explore/api/universes/mapsense.hurricanes/{Z}/{X}/{Y}.topojson?api-key={API_KEY}";
var hurricaneLayer = mapsense.topoJson().url(mapsense.url(hurricaneUrl).hosts(['a','b','c','d']));
map.add(hurricaneLayer);</pre>
To filter which features are returned in the Mapsense tiles, you can add querries to the URL.  For example, to only see huricanes named George:
<pre class="prettyprint lang-js ">
var hurricaneUrl = "https://{S}-api.mapsense.co/explore/api/universes/mapsense.hurricanes/{Z}/{X}/{Y}.topojson?api-key={API_KEY}&where=Name==George";</pre>
Read <a href="tileQueries">this</a> for more information on the Mapsense API query language, or check out this example:
<div class="row">
      <div class="col-lg-3 col-sm-4">
        <a href="http://bl.ocks.org/mapsense-examples/84ae92261794f5d8db19" class="thumbnail" target="_blank">
          <img src="../../examples/images/hurricane.jpg">
          <div>data-driven maps</div>
        </a>
      </div>
  </div>

    <br/>
    <h4><b>Custom layers</b></h4>

    Custom layers can be created by extending either the layer, geoJson, or topoJson classes and providing a map() function which takes the map object as an argument as well as registering any event listeners for that layer.  The event listeners should call map.pan() and map.zoom() to manipulate the map view point if needed.
    <pre class="prettyprint lang-js ">
var myLayer = function() {
  var myLayer = mapsense.geoJson();

  var __map__ = myLayer.map;
  myLayer.map = function(m) {
    if (!arguments.length) return __map__();
    __map__(m);
    // add event listeners and do any other initialization
    window.addEventListener("mousedownCallback", mousedown, false);
  }

  return myLayer;
}
...
map.add(myLayer());</pre>
    <br/>
    <h4><b>An example - coloring buildings by height</b></h4>

    We can dynamically set the style of map features using the selection function.  For example, the following code initializes a map and colors features according to their height by specifying a selection function which sets the fill style of each attribute by mapping the feature's height property by a linear color gradient: </p>
<pre class="prettyprint lang-js "> &ltstyle&gt
    #mapContainer{
      width: 100%;
      height: 400px;
      padding: 5px;
    }
    .mapFeatures {
      vector-effect: non-scaling-stroke;
      stroke: rgb(129, 129, 129);
      stroke-width: .7;
      fill : none;
    }
&lt/style&gt
&ltdiv id="mapContainer"&gt&lt/div&gt
&ltscript&gt
  var map = mapsense.map("#mapContainer")
        .center({lon: -74.01142888140966, lat: 40.70861546602194})
        .zoomRange([15.5,15.5])
        .zoom(15.5);

  var colorRamp = d3.scale.linear().domain([0,50,250]).range(['rgb(254,224,210)','rgb(252,146,114)','rgb(222,45,38)']);

  map.add(
    mapsense.basemap()
    .apiKey("key-2d5eacd8b924489c8ed5e8418bd883bc")
    .selection(
      function(d){
      d.attr('class',"mapFeatures")
       .style("fill", function(d){
        return colorRamp(d.properties.height);
      })
    }));
&ltscript&gt</pre>
<style>
    #mapContainer{
      width: 100%;
      height: 400px;
      padding: 5px;
    }
    .mapsense-map{
      width: 100%;
      height: 100%;
    }
    .mapFeatures {
      vector-effect: non-scaling-stroke;
      stroke: rgb(129, 129, 129);
      stroke-width: .7;
      fill : none;
    }
    .tile-background{
      fill: rgb(79,79,79);
    }
    </style>
    <div id="mapContainer"></div>
    <script>

      var map = mapsense.map("#mapContainer")
        .center({lon: -74.01142888140966, lat: 40.70861546602194})
        .zoomRange([15.5,15.5])
        .zoom(15.5);

      var colorRamp = d3.scale.linear().domain([0,50,250]).range(['rgb(254,224,210)','rgb(252,146,114)','rgb(222,45,38)']);

      map.add(
        mapsense.basemap()
        .apiKey("key-2d5eacd8b924489c8ed5e8418bd883bc")
        .selection(
          function(d){
          d.attr('class',"mapFeatures")
           .style("fill", function(d){
            return colorRamp(d.properties.height);
          })
        }));

    </script>
    <p></p>
</div>

        </div>
      </div>
    </div>
    <footer class="footer">
  <div class="container text-center">
    <div>Designed, built, and maintained with love by the team at Mapsense</div>
    <div>
      <a href="https://github.com/mapsense/mapsense.js" target="_blank">GitHub</a> -
      <a href="http://www.mapsense.co/gallery/" target="_blank">Gallery</a> -
      <a href="http://www.mapsense.co/blog/" target="_blank">Blog</a> -
      <a href="https://twitter.com/Mapsense/" target="_blank">Twitter</a> -
      <a href="https://github.com/mapsense/mapsense.js/issues" target="_blank">Issues</a> -
      <a href="http://www.mapsense.co/tos/" target="_blank">Terms</a> -
      <a href="http://www.mapsense.co/contact/" target="_blank">About</a> -
      <a href="mailto:support@mapsense.co" target="_blank">Contact Us</a>:
      <a href="mailto:support@mapsense.co" target="_blank">support@mapsense.co</a>
    </div>
    <div class="copyright">&copy; 2015 Mapsense Inc.</div>
  </div>
</footer>

  </body>
</html>
