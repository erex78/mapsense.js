<!doctype html>
<html>
  <head>
  <link rel="shortcut icon" href="/images/favicon.ico" type="image/png">
<link rel="apple-touch-icon" href="/images/mapsense-icon-60.png" sizes="60x60">
<link rel="apple-touch-icon" href="/images/mapsense-icon-76.png" sizes="76x76">
<link rel="apple-touch-icon" href="/images/mapsense-icon-120.png" sizes="120x120">
<link rel="apple-touch-icon" href="/images/mapsense-icon-152.png" sizes="152x152">

  <link href='//fonts.googleapis.com/css?family=Quattrocento+Sans:400,700' rel='stylesheet' type='text/css'>
  <script src="//google-code-prettify.googlecode.com/svn/loader/run_prettify.js"></script>
  <link href="stylesheets/normalize.css" rel="stylesheet" type="text/css" />
  <link href="stylesheets/all.css" rel="stylesheet" type="text/css" />
  <link href="stylesheets/stickyFooter.css" rel="stylesheet" type="text/css" />
  <style>
    tbody{
      background-color: white;
    }
    thead{
      background-color: #EEE;
    }
    .container{
      margin-bottom: 150px;
    }
    footer.footer div.container{
      margin-bottom: 0;
    }
    pre.prettyprint {
      padding:15px 15px !important;
    }
    div.main-content { background-color: #ffffff; }
  </style>
    <meta charset="utf-8">
    
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    
    <title>Mapsense Developer</title>
    
    <script src="//javascripts/all.js" type="text/javascript"></script>
  </head>
  
  <body>
    <div class="container">
      <div class="row">
        <aside class="col-md-2 col-sm-2">
          
<h3>Mapsense.js</h3>
	<ul>
		<li>
			<h4>Core</h4>
			<ul class="list-unstyled">
			<li><a href="map.html">map</a></li>
			<li><a href="basemap.html">basemap</a></li>
			<li><a href="layer.html">layer</a></li>
			<li><a href="image.html">image</a></li>
			<li><a href="geoJson.html">geoJson</a></li>
			<li><a href="topoJson.html">topoJson</a></li>
			</ul>
		</li>
		<li>
			<h4>Controls</h4>
			<ul class="list-unstyled">
			<li><a href="arrow.html">arrow</a></li>
			<li><a href="compass.html">compass</a></li>
			<li><a href="dblclick.html">dblclick</a></li>
			<li><a href="drag.html">drag</a></li>
			<li><a href="grid.html">grid</a></li>
			<li><a href="hash.html">hash</a></li>
			<li><a href="interact.html">interact</a></li>
			<li><a href="wheel.html">wheel</a></li>
			</ul>
		</li>
		<li>
			<h4>Et cetera</h4>
			<ul class="list-unstyled">
			<li><a href="attribution.html">attribution</a></li>
			<li><a href="cache.html">cache</a></li>
			<li><a href="dispatch.html">dispatch</a></li>
			<li><a href="queue.html">queue</a></li>
			<li><a href="svg.html">svg</a></li>
			<li><a href="transform.html">transform</a></li>
			<li><a href="url.html">url</a></li>
			</ul>
		</li>
	</ul>

<h3 > <a href='/tileViewer'>Mapsense Data </a> </h3>
<ul>
	<ul class= "list-unstyled">
	<li><a href="tileRequests.html">Tile Paths</a></li>
	<li><a href="tileQueries.html">Tile Queries</a></li>
	<li><a href="featureProperties.html"> Feature Properties</a></li>
	<li><a href="contextAPI.html">Context API</a></li>
</ul>
</ul>

        </aside>
        <div class="col-md-10 col-sm-10 main-content">
          <div class="span-18 prepend-6 last">

   <h2 id="tiles">Context API</h2>

   <hr class="space"/>
   <p>The Context API returns the polygons that intersect the given point. The query parameters <code class="prettyprint">where</code> and <code class="prettyprint">select</code> are accepted to filter the response.</p>

   <p>Context API request format:</p>
   <pre class="prettyprint lang-html">https://api.mapsense.co/universes/<b>{DATASET}</b>/intersects?geometry=POINT(<b>{LON}%20{LAT}</b>)&api-key=<b>{KEY}</b>&{QUERY}</pre>
   <br>
   <h4 id="optional-query-parameters">Query Parameters</h4>
   <table class='table-bordered table'>
      <thead>
         <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Default</th>
            <th>Description</th>
         </tr>
      </thead>
      <tbody>
         <tr>
            <td>geometry</td>
            <td>wkt (POINT)</td>
            <td>&mdash;</td>
            <td>A wkt point of the form  <code class="prettyprint">POINT(lon lat)</code>. </td>
         </tr>
         <tr>
            <td><a href="http://docs.mapsense.co/#query-a-tile">select</a></td>
            <td>string</td>
            <td>&mdash;</td>
            <td>A comma separated list of meta-data fields to return on each feature eg. <code class="prettyprint">select=layer, sub_layer, name</code>. </td>
         </tr>
         <tr>
            <td><a href="http://docs.mapsense.co/#query-a-tile">where</a></td>
            <td>string</td>
            <td>&mdash;</td>
            <td>A boolean expression to filter the result set, eg. <code class="prettyprint">where=sub_layer==&#39;motorways&#39;</code>. Only features that satisfy the boolean expression will be returned.</td>
         </tr>
      </tbody>
   </table>

     <h4>Demo</h4>
     Here's a demo of the Context API used with OpenStreetMap and U.S. Census tiles <a target="_blank" href="http://bl.ocks.org/mapsense-examples/raw/3b2430bc38cee41fb882/">http://bl.ocks.org/mapsense-examples/raw/3b2430bc38cee41fb882/</a>


     <h4>Examples</h4>
     <p>A query for several attributes of OpenStreetMap polygons containing the point at -122.41561, 37.78764: </p>
     <pre class="prettyprint lang-html ">https://api.mapsense.co/universes/mapsense.osm_pip/intersects?geometry=POINT(-122.41561%2037.78764)&api-key={KEY}&select=name,way_area,osm_id,boundary,admin_level,leisure,wikipedia</pre>

     <p>Above request returns the information as JSON:

     <pre class="prettyprint lang-javascript ">
{
    "data": {
        "relations": [
            [1885211, 2037093, 2040571, 2695473, 48632178]
        ],
        "layers": {
            "polygons": {
                "48632178": {
                    "name": "United States of America",
                    "osm_id": -148838,
                    "wikipedia": "en:United States",
                    "way_area": 2.41979003E13,
                    "boundary": "administrative",
                    "admin_level": "2"
                },
                "1885211": {
                    "name": "San Francisco City and County",
                    "way_area": 9.6263501E8,
                    "osm_id": -396487,
                    "boundary": "administrative",
                    "admin_level": "6"
                },
                "2037093": {
                    "osm_id": 71739086,
                    "way_area": 331.246
                },
                "2695473": {
                    "osm_id": -165475,
                    "way_area": 6.6721697E11,
                    "wikipedia": "en:California",
                    "boundary": "administrative",
                    "admin_level": "4",
                    "name": "California"
                },
                "2040571": {
                    "way_area": 4.45513984E8,
                    "wikipedia": "en:San Francisco",
                    "osm_id": -111968,
                    "boundary": "administrative",
                    "admin_level": "8",
                    "name": "San Francisco"
                }
            }
        }
    }
}
     </pre>



</div>

        </div>
      </div>
    </div>
    <footer class="footer">
  <div class="container text-center">
    <div>Designed, built, and maintained with love by the team at Mapsense</div>
    <div>
      <a href="https://github.com/mapsense/mapsense.js" target="_blank">GitHub</a> -
      <a href="http://www.mapsense.co/gallery/" target="_blank">Gallery</a> -
      <a href="http://www.mapsense.co/blog/" target="_blank">Blog</a> -
      <a href="https://twitter.com/Mapsense/" target="_blank">Twitter</a> -
      <a href="https://github.com/mapsense/mapsense.js/issues" target="_blank">Issues</a> -
      <a href="http://www.mapsense.co/tos/" target="_blank">Terms</a> -
      <a href="http://www.mapsense.co/contact/" target="_blank">About</a> -
      <a href="mailto:support@mapsense.co" target="_blank">Contact Us</a>:
      <a href="mailto:support@mapsense.co" target="_blank">support@mapsense.co</a>
    </div>
    <div class="copyright">&copy; 2015 Mapsense Inc.</div>
  </div>
</footer>

  </body>
</html>
